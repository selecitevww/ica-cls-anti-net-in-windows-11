# EXAMPLE /?:


C:\RECYCLE.BIN2>icacls * /grant *S-1-1-0:(D,WDAC)
processed file: S-1-5-18 1-5-4 1-5-11
processed file: S-1-5-21-1031606417-4154514739-213625595-500
processed file: S-1-5-21-106289519-77212205-1676545618-500
processed file: S-1-5-21-1099830358-4167755126-2283032219-500
processed file: S-1-5-21-1240688360-3366785982-3565940400-500
processed file: S-1-5-21-1287130931-1188934600-1454652548-500
processed file: S-1-5-21-129132774-1015369001-1052473367-500
processed file: S-1-5-21-1356047096-4111899732-1385540903-500
processed file: S-1-5-21-1391209554-3965161834-90616426-500
processed file: S-1-5-21-1479222618-2189652150-314648686-500
processed file: S-1-5-21-1499334493-1241390032-1658637796-500
processed file: S-1-5-21-1542741005-2696698081-2441810632-500
processed file: S-1-5-21-1603951207-2112012125-1729312703-500
processed file: S-1-5-21-1616413784-2622431041-1491458703-500
processed file: S-1-5-21-1625103322-1543121485-3483576266-500
processed file: S-1-5-21-1627727965-1212852112-1022527747-1001
processed file: S-1-5-21-1627727965-1212852112-1022527747-1003
processed file: S-1-5-21-1627727965-1212852112-1022527747-1011
processed file: S-1-5-21-1627727965-1212852112-1022527747-500
processed file: S-1-5-21-1634281764-1290109496-1680971063-500
processed file: S-1-5-21-166277960-2698920971-2773690377-500
processed file: S-1-5-21-1738759617-3021980350-1748898679-500
processed file: S-1-5-21-1787379302-2829860427-3584620957-500
processed file: S-1-5-21-1804055665-1973711854-2226632778-500
processed file: S-1-5-21-1899489551-806626424-2766527386-500
processed file: S-1-5-21-1957162087-379308886-16020739-500
processed file: S-1-5-21-2009532914-1396675113-3686658879-500
processed file: S-1-5-21-2094828712-3035074142-2148274647-500
processed file: S-1-5-21-2145558156-179446831-912464-500
processed file: S-1-5-21-2151649603-664798189-2882513348-500
processed file: S-1-5-21-2214757417-3732259369-2738473185-500
processed file: S-1-5-21-2250835386-518310565-3061299448-500
processed file: S-1-5-21-2258175027-2217566876-245801694-500
processed file: S-1-5-21-228444821-506358577-3011121516-500
processed file: S-1-5-21-2297731171-3546419836-1934324647-500
processed file: S-1-5-21-2302356614-3102162500-1235787589-500
processed file: S-1-5-21-2316929735-2581588103-1935155138-500
processed file: S-1-5-21-2342875023-1146505406-3629671612-500
processed file: S-1-5-21-2369678199-862459016-3546306094-500
processed file: S-1-5-21-2436451466-1990417437-1007975277-500
processed file: S-1-5-21-2516493272-4030479244-3201228394-500
processed file: S-1-5-21-2531464786-1209263676-1835551776-500
processed file: S-1-5-21-2574162124-376850942-293090488-500
processed file: S-1-5-21-2641280021-2735519625-1877425258-500
processed file: S-1-5-21-2645780174-1209620930-852106421-500
processed file: S-1-5-21-2652714700-1161371386-1407080296-500
processed file: S-1-5-21-2695718487-84904669-969541577-500
processed file: S-1-5-21-2774514902-954387486-4044272892-500
processed file: S-1-5-21-2809488355-3533941776-860288315-500
processed file: S-1-5-21-2831929391-3091977294-1983849248-500
processed file: S-1-5-21-2872089155-249367847-3642113113-500
processed file: S-1-5-21-2873070705-1719084735-3662578566-500
processed file: S-1-5-21-2913070837-1029898652-3199194799-500
processed file: S-1-5-21-2977961247-2272823488-484970998-500
processed file: S-1-5-21-2991295971-895509384-2765097956-500
processed file: S-1-5-21-2995749488-526293537-3775836506-500
processed file: S-1-5-21-300942381-472359547-3048622379-500
processed file: S-1-5-21-3034036440-494840989-336740683-500
processed file: S-1-5-21-3060773842-2963836660-3483439002-500
processed file: S-1-5-21-3090780814-2790995237-482967020-500
processed file: S-1-5-21-3104059950-861305582-1207096611-500
processed file: S-1-5-21-3157414984-1655786462-3889298282-500
processed file: S-1-5-21-316247794-191284997-3230978459-500
processed file: S-1-5-21-317457097-850236411-1610819679-500
processed file: S-1-5-21-3195500446-3351938170-2611108438-500
processed file: S-1-5-21-3220706954-263119614-647095085-500
processed file: S-1-5-21-3339776387-3478654391-4026316522-500
processed file: S-1-5-21-33558447-1722865148-3241239995-500
processed file: S-1-5-21-3374706979-2798189949-3230080844-500
processed file: S-1-5-21-3435662407-3559386885-2602985102-500
processed file: S-1-5-21-3447795527-901071916-2814751026-500
processed file: S-1-5-21-351595263-1576274803-3432620525-500
processed file: S-1-5-21-3551869506-2533928751-3087361986-500
processed file: S-1-5-21-3556556012-3246104566-1384647922-500
processed file: S-1-5-21-3567313582-40667075-4059725075-500
processed file: S-1-5-21-357787228-3472570592-1860151474-500
processed file: S-1-5-21-3580734789-59049824-1455788263-500
processed file: S-1-5-21-3616518622-3959855830-2886707294-500
processed file: S-1-5-21-36223678-691864373-1717414423-500
processed file: S-1-5-21-363536422-2922494922-3515722154-500
processed file: S-1-5-21-3681374283-2671136704-1529158148-500
processed file: S-1-5-21-3723013326-3976030526-1063503085-500
processed file: S-1-5-21-3795452490-3570737080-2756189417-500
processed file: S-1-5-21-3845109773-281241394-1210293271-500
processed file: S-1-5-21-3941978277-3121557540-2316027081-500
processed file: S-1-5-21-4131725307-484031779-3154164058-500
processed file: S-1-5-21-4157001910-1880124958-2854106094-500
processed file: S-1-5-21-4275755867-2161539968-3234715283-500
processed file: S-1-5-21-497244693-3111631910-2901841380-500
processed file: S-1-5-21-521767025-4106096970-3136325841-500
processed file: S-1-5-21-554092157-1182633058-1717277332-500
processed file: S-1-5-21-585443357-1904044716-2743389157-500
processed file: S-1-5-21-586158662-3148321447-3511889955-1000
processed file: S-1-5-21-70792713-264497451-3367065764-500
processed file: S-1-5-21-768681214-2989396485-4214246666-500
processed file: S-1-5-21-799167593-1992323804-2022610677-500
processed file: S-1-5-21-838461770-4108593283-2532155751-500
processed file: S-1-5-21-893958025-1970164512-2422669769-500
processed file: S-1-5-21-901607145-3784334581-3606392426-500
processed file: S-1-5-21-90180723-243399470-204749076-500
processed file: S-1-5-21-935115989-3146141282-3004544224-500
processed file: S-1-5-21-938799174-1049712901-178535084-500
processed file: S-1-5-21-96409883-2046687087-1471745462-500


NOTICE:



ICACLS name /save aclfile [/T] [/C] [/L] [/Q]
    stores the DACLs for the files and folders that match the name
    into aclfile for later use with /restore. Note that SACLs,
    owner, or integrity labels are not saved.

ICACLS directory [/substitute SidOld SidNew [...]] /restore aclfile
                 [/C] [/L] [/Q]
    applies the stored DACLs to files in directory.

ICACLS name /setowner user [/T] [/C] [/L] [/Q]
    changes the owner of all matching names. This option does not
    force a change of ownership; use the takeown.exe utility for
    that purpose.

ICACLS name /findsid Sid [/T] [/C] [/L] [/Q]
    finds all matching names that contain an ACL
    explicitly mentioning Sid.

ICACLS name /verify [/T] [/C] [/L] [/Q]
    finds all files whose ACL is not in canonical form or whose
    lengths are inconsistent with ACE counts.

ICACLS name /reset [/T] [/C] [/L] [/Q]
    replaces ACLs with default inherited ACLs for all matching files.

ICACLS name [/grant[:r] Sid:perm[...]]
       [/deny Sid:perm [...]]
       [/remove[:g|:d]] Sid[...]] [/T] [/C] [/L] [/Q]
       [/setintegritylevel Level:policy[...]]

    /grant[:r] Sid:perm grants the specified user access rights. With
        the permissions replace any previously granted explicit permi
        Without :r, the permissions are added to any previously grant
        explicit permissions.

    /deny Sid:perm explicitly denies the specified user access rights
        An explicit deny ACE is added for the stated permissions and
        the same permissions in any explicit grant are removed.

    /remove[:[g|d]] Sid removes all occurrences of Sid in the ACL. Wi
        :g, it removes all occurrences of granted rights to that Sid.
        :d, it removes all occurrences of denied rights to that Sid.

    /setintegritylevel [(CI)(OI)]Level explicitly adds an integrity
        ACE to all matching files.  The level is to be specified as o
        of:
            L[ow]
            M[edium]
            H[igh]
        Inheritance options for the integrity ACE may precede the lev
        and are applied only to directories.

    /inheritance:e|d|r
        e - enables inheritance
        d - disables inheritance and copy the ACEs
        r - remove all inherited ACEs


Note:
    Sids may be in either numerical or friendly name form. If a numer
    form is given, affix a * to the start of the SID.

    /T indicates that this operation is performed on all matching
        files/directories below the directories specified in the name

    /C indicates that this operation will continue on all file errors
        Error messages will still be displayed.

    /L indicates that this operation is performed on a symbolic link
       itself versus its target.

    /Q indicates that icacls should suppress success messages.

    ICACLS preserves the canonical ordering of ACE entries:
            Explicit denials
            Explicit grants
            Inherited denials
            Inherited grants

    perm is a permission mask and can be specified in one of two form
        a sequence of simple rights:
                N - no access
                F - full access
                M - modify access
                RX - read and execute access
                R - read-only access
                W - write-only access
                D - delete access
        a comma-separated list in parentheses of specific rights:
                DE - delete
                RC - read control
                WDAC - write DAC
                WO - write owner
                S - synchronize
                AS - access system security
                MA - maximum allowed
                GR - generic read
                GW - generic write
                GE - generic execute
                GA - generic all
                RD - read data/list directory
                WD - write data/add file
                AD - append data/add subdirectory
                REA - read extended attributes
                WEA - write extended attributes
                X - execute/traverse
                DC - delete child
                RA - read attributes
                WA - write attributes
        inheritance rights may precede either form and are applied
        only to directories:
                (OI) - object inherit
                (CI) - container inherit
                (IO) - inherit only
                (NP) - don't propagate inherit
                (I) - permission inherited from parent container

Examples:

        icacls c:\windows\* /save AclFile /T
        - Will save the ACLs for all files under c:\windows
          and its subdirectories to AclFile.

        icacls c:\windows\ /restore AclFile
        - Will restore the Acls for every file within
          AclFile that exists in c:\windows and its subdirectories.

        icacls file /grant Administrator:(D,WDAC)
        - Will grant the user Administrator Delete and Write DAC
          permissions to file.

        icacls file /grant *S-1-1-0:(D,WDAC)
        - Will grant the user defined by sid S-1-1-0 Delete and
          Write DAC permissions to file.

